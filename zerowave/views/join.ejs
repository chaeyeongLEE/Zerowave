<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Join Form</title>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <link rel="stylesheet" href="/static/css/join.css">
</head>
<body>  
    <div class="wrapper">
        <div class="item">
            <div class="log"><h1>Join</h1></div>

            <form action="" class="join_form">
                <input  type="text" placeholder="이름" class="in" name="user_name">
                <div name="user_email">
                    <input type="text" placeholder="아이디" class="inId">
                        <span>@</span>
                    <input type="text" placeholder="이메일" class="inEmail" id="domain-txt">
                    <select id="domain-list">
                        <option value="type">직접 입력</option>
                        <option value="naver.com">naver.com</option>
                        <option value="google.com">google.com</option>
                        <option value="hanmail.net">hanmail.net</option>
                        <option value="nate.com">nate.com</option>
                        <option value="kakao.com">kakao.com</option>
                    </select>
                </div>
                
                <input type="password" placeholder="비밀번호" class="in" name="user_pw">
                <input type="password" placeholder="비밀번호 확인" class="in" name="user_pw">

                <p class="birth">생년월일</p>
                <div class="info" id="info_birth">
                    <select class="box" id="birth-year">
                      <option disabled selected>출생 연도</option>
                    </select>
                    <select class="box" id="birth-month">
                      <option disabled selected>월</option>
                    </select>
                    <select class="box" id="birth-day">
                      <option disabled selected>일</option>
                    </select>
                </div>
                <input type="submit" id="btn" value="회원가입" onclick="join()"><br>
            </form>


        </div>
    </div>

    <script>
            const domainListEl = document.querySelector('#domain-list')
            const domainInputEl = document.querySelector('#domain-txt')
            domainListEl.addEventListener('change', (event) => {
            if(event.target.value !== "type") {
            domainInputEl.value = event.target.value
            domainInputEl.disabled = true
                } else { 
            domainInputEl.value = ""
            domainInputEl.disabled = false
            }
        });        
            const birthYearEl = document.querySelector('#birth-year')
            isYearOptionExisted = false;
            birthYearEl.addEventListener('focus', function () {
                if(!isYearOptionExisted) {
                YearOptionExisted = true
                for(var i = 1940; i <= 2022; i++) {
            const YearOption = document.createElement('option')
                YearOption.setAttribute('value', i)
                YearOption.innerText = i
                this.appendChild(YearOption);
                }
            }
        });
            const birthMonthEl = document.querySelector('#birth-month')
            isMonthOptionExisted = false;
            birthMonthEl.addEventListener('focus', function () {
                if(!isMonthOptionExisted) {
                    isMonthOptionExisted = true
                for(var i = 1; i <= 12; i++) {
            const MonthOption = document.createElement('option')
                MonthOption.setAttribute('value', i)
                MonthOption.innerText = i
                this.appendChild(MonthOption);
                }
            }
        });
            const birthDayEl = document.querySelector('#birth-day')
            isDayOptionExisted = false;
            birthDayEl.addEventListener('focus', function () {
                if(!isDayOptionExisted) {
                    isDayOptionExisted = true
                for(var i = 1; i <= 31; i++) {
            const DayOption = document.createElement('option')
                DayOption.setAttribute('value', i)
                DayOption.innerText = i
                this.appendChild(DayOption);
                }
            }
        });


    function join(){
        let form = document.querySelector("#join_form"); 
        let data = { email : form.user_email.value , 
                        pw : form.user_pw.value , 
                      name : form.user_name.value }
            if(!form.user_email.value&& !form.user_pw.value && !form.user_name.value){
                alert("값을 입력해주세요");
                }
                axios({
                     method : "post",
                        url : "/join",
                     data : data
                 }).then((res)=>{
                     location.href = "/login";
                 })
}

    </script>
 
</body>
</html>